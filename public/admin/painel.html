<body>
  <h1>Painel do Administrador ‚öôÔ∏è</h1>

  <h2>Configura√ß√µes do App</h2>
  <label>Nome do App:</label><br>
  <input id="appName" placeholder="Ex: Pitombo Lanches"><br><br>

  <h2>Gerenciar Card√°pio üçî</h2>
  <div id="menu"></div>
  <button onclick="salvar()">üíæ Salvar Altera√ß√µes</button>

  <p id="msg" style="color: green;"></p>

  <script>
    async function carregarPainel() {
      try {
        const res = await fetch('/api/menu');
        const menu = await res.json();
        const div = document.getElementById('menu');
        div.innerHTML = menu.map(item => `
          <div style="margin-bottom: 20px;">
            <input id="nome-${item.id}" value="${item.nome}">
            <input id="preco-${item.id}" type="number" value="${item.preco}">
            <input id="img-${item.id}" value="${item.imagem}" placeholder="URL da imagem">
          </div>
        `).join('');

        const cfgRes = await fetch('/api/config');
        const cfg = await cfgRes.json();
        document.getElementById('appName').value = cfg.appName || '';
      } catch (e) {
        document.getElementById('msg').textContent = 'Erro ao carregar painel.';
      }
    }

    async function salvar() {
      const appName = document.getElementById('appName').value;
      const resMenu = await fetch('/api/menu');
      const menu = await resMenu.json();

      const novoMenu = menu.map(item => ({
        id: item.id,
        nome: document.getElementById(`nome-${item.id}`).value,
        preco: Number(document.getElementById(`preco-${item.id}`).value),
        imagem: document.getElementById(`img-${item.id}`).value
      }));

      const cfg = { appName, menu: novoMenu };
      localStorage.setItem('painelConfig', JSON.stringify(cfg));
      document.getElementById('msg').textContent = 'Altera√ß√µes salvas localmente!';
    }

    carregarPainel();
  </script>
</body>
